# Lesson 10 - Admin Views

## LEARN

### Week 4 - Data
* Lesson 9 - Database
* Lesson 10 - Admin Views
* Lesson 11 - ListView
* Project 4 - Basic Views
* Django for Beginners - Chapter 4


### Admin views
* Show Data Records
* Allow direct editing of records
* Quick way to build prototypes


### Data Models
- ORM - Object Relational Mapping
- Data Models define the table structure
- Database tables are created by code


### Hero Data Model

hero/models.py

    from django.db import models

    class Hero (models.Model):
        name = models.CharField(max_length=100)
        description = models.TextField()
        image = models.CharField(max_length=200)

hero/admin.py

    from django.contrib import admin
    from .models import Hero

    admin.site.register(Hero)


### Migration
Examine code for changes to Data Models

    $ python manage.py makemigrations

Apply changes to Data Tables

    $ python manage.py migrate


### Templates

templates/index.html

    <h1>Superhero Gallery</h1>

    <a href="/admin/">Django Admin Views</a>


### Views

hero/views.py

    from django.views.generic import TemplateView

    class IndexView(TemplateView):
        template_name = 'index.html'


### URLs

config/urls.py

    from django.urls import path
    from hero.views import IndexView
    from django.contrib import admin

    urlpatterns = [
        path('admin/', admin.site.urls),
        path('', IndexView.as_view()),
    ]


### Test and fix

    $ python manage.py runserver
    $ browse to 127.0.0.1:8000


### ListView

templates/hero_list.html

    <h1>Superhero Gallery</h1>
    <ul>
      {% for hero in object_list %}
        <li>{{ hero.name }}</li>
      {% endfor %}
    </ul>

hero/views.py

    from django.views.generic import ListView

    class HeroListView(ListView):
        model = Hero
        template_name = 'hero_list.html'

config/urls.py

    from django.urls import path
    from hero.views import HeroListView

    urlpatterns = [
        path('hero/', HeroListView.as_view()),
    ]



## BUILD - Development Workflow

### Short-cuts
* Sensei
* Github repo
* Web app
* Python Anywhere config
* Python Anywhere console


### Development Workflow
* Pull code
* Make changes
* Test changes
* Push changes
* Deploy


### Data Model

### Admin Views
* Superuser required
* Edit hero/admin.py to add Hero
* Edit config/urls.py to add "admin/"
* Test


### ListView
templates/hero_list.html

    <ul>
      {% for hero in object_list %}
        <li>{{ hero.name }}</li>
      {% endfor %}
    </ul>

hero/views.py

    class HeroListView(ListView):
        model = Hero
        template_name = 'hero_list.html'

config/urls.py

    urlpatterns = [
        path('hero/', HeroListView.as_view()),
    ]


### Test and fix

    $ python manage.py runserver
    $ browse to 127.0.0.1:8000
    $ git add . && git commit -m "Hero List View"


### Django Tests

hero/tests.py

    from django.test import SimpleTestCase

    class SimpleTests(SimpleTestCase):
        def test_home_page_status_code(self):
            response = self.client.get('/')
            self.assertEqual(response.status_code, 200)

Run all tests

    $ python manage.py test


### Tests
* Rerun the django tests
* Add test for "/hero/" page
* Fails because it needs a database
* Switch from SimpleTestCase to TestCase



